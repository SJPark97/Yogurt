# 도커의 기본

강의 번호: Docker
날짜: 2023년 1월 5일
복습: No
작성일시: 2023년 1월 5일 오후 4:38

## 도커의 기본적인 흐름

도커에서는 이미지 단위로 

```jsx
docker run hello-world
```

위의 코드를 실행하게 되면 

도커는 run(실행)시키기 위한 hello-world란 이름의 이미지가 있는지 

로컬위치에서 찾아보게 된다.

만약에 없다면 도커허브에서도 찾아보게된다. 있다면 풀링(Pulling) 해와서 안의 코드대로 실행한다.

즉 도커클라이언트에서 명령을 받으면 도커Server(Daemon)에서 찾아온 자료로 작업을 하게된다.

## 도커와 가상화 기술과의 차이를 통한 컨테이너 이해

### 가상화 기술 이전

- 하나의 서버를 하나의 용도로만 사용
- 하나의 서버에 하나의 운영체제 , 하나의 프로그램 운용
- 안정적이지만 비효율적인 사용

### 하이퍼 바이저 기반의 가상화출현

- 논리적으로 공간을 분할하는 VM을 이용 가능
- 하이퍼바이저는  하드웨어를 직접 제어하는 네이티브 하이퍼바이저와
    
    보통 많이 사용하는 OS위에서 실행하게 되는 호스트형 하이퍼바이저가 존재
    
    하지만 기본 OS위에 존재하며 , 바로위의 가상OS를 또 제어하기 때문에 오버헤드가 
    
    큰 대신 적은 제약으로 활용가능하다.
    

### 하이퍼바이저 기반의 VM 구조

하이퍼바이저는 각 VM마다 , 독립된 자원을 받고 그위에서 구동되기 때문에 에러 발생시 서로 간섭하지 않는다.

### 가상화 기술과 도커의 차이

가상화 기술은 ,  각각의 머신마다 게스트OS와 하이퍼바이저 가 필요하기 때문에 도커의 컨테이너 보다 무겁다. 

또한 도커의 경우 호스트 OS위에서 어플리케이션 실행 패키지인 이미지를 배포하기만 하면되는데, VM은 VM을 띄우고 , 게스트OS를 부팅하여 어플리케이션을 실행하는등 복잡한 과정을 거쳐야 한다.

도커 컨테이너 내에서 실행되는 프로세스들은 모두 동일한 호스트OS에서 실행되기 때문에 호스트OS에서 모두 볼 수 있다는 점이다.

가상컨테이너는 VM위에서 게스트 OS를 실행시키는 방식으로 방식 자체는 간단하지만 위에서 보듯 OS자체가 굉장히 무겁다.

### 도커 컨테이너의 격리 방식

컨테이너와 호스트에서 실행되는 다른 프로세스 사이에 벽을 만드는 리눅스 커널 기능인 

Cgroup과 네임스페이스를 알아야 한다.

### C group

CPU , 메모리 등 프로세스 그룹의 시스템 리소스 사용량을 관리하는 것.

ex) 어떤 어플이 사용량이 너무 많을때 , 그 어플같은 것을 C group에 넣어서 CPU와 메모리 사용제한 할수 있다.

### 네임 스페이스

하나의 시스템에서 프로세스를 격리시킬수 있는 가상화기술. 별개의 독립된 공간을 사용하는 것처럼 격리된 환경을 제공하는 경량 프로세스 경량 터널.

## 이미지로 컨테이너 만들기

 - 이미지는 응용프로그램을 실행하기 위한 모든것을 가지고 있음

 →필요한것 : 컨테이너가 시작될때 실행되는 명령어 ,파일 스냅샷(디렉토리나 파일을 카피한것) 필요함

### 이미지로 컨테이너 만드는 순서

1. 이미지의 내용을 기반으로 docker 컨테이너가 생성된다.
2. 이미지에서 받아온 명령어와 파일 스냅샷을 기반으로 프로그램 실행

도커가 돌아갈때 , 호스트 OS는 그대로 있지만, 도커는 리눅스환경에서 돌아가므로 컨테이너를 나눠서 돌릴수 있음.